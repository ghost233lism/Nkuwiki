<!--pages/profile/edit/edit.wxml-->
<!-- 顶部消息提示 -->
<mp-toptips msg="{{toptipsMsg}}" type="{{toptipsType}}" show="{{toptipsShow}}"></mp-toptips>

<view class="container">
  <!-- 导航栏 -->
  <nav-bar nav-buttons="{{navButtons}}"></nav-bar>

  <!-- 内容区域 -->
  <view class="content-area">
    <cell-status
      loading="{{loading}}"
      error="{{error}}"
      errorMsg="{{errorMsg}}"
      bindretry="onRetry">

      <!-- 头像 -->
      <view class="avatar-section">
        <button class="avatar-wrapper" open-type="chooseAvatar" bindchooseavatar="onChooseAvatar">
          <image 
            class="avatar" 
            src="{{userInfo.avatar || defaultAvatar}}"
            binderror="onAvatarError"
          ></image>
        </button>
        <view class="avatar-hint">点击更换头像</view>
      </view>

      <!-- 使用表单面板组件 -->
      <form-panel 
        id="profileForm"
        fields="{{formFields}}"
        groups="{{groups}}"
        ranges="{{ranges}}"
        submitText="保存修改"
        submitTextBackground="#666"
        bind:change="onFieldChange"
        bind:submit="onFormSubmit"
      ></form-panel>
      
    </cell-status>
  </view>
</view>