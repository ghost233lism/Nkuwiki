<!-- notification.wxml -->
<view class="container">
  <!-- 自定义导航栏 -->
  <nav-bar title="消息通知" bind:back="onBack"></nav-bar>

  <!-- 内容区域 -->
  <view class="content-area">
    <!-- 使用cell-status组件 -->
    <cell-status
      loading="{{loading}}"
      error="{{error}}"
      errorMsg="{{errorMsg}}"
      bindretry="onRetry">

      <!-- 标签页 -->
      <view class="tab-container">
        <view class="tabs">
          <view
            wx:for="{{tabs}}"
            wx:key="value"
            class="tab {{activeTab === item.value ? 'active' : ''}}"
            data-tab="{{item.value}}"
            bindtap="onTabChange"
          >
            <text>{{item.label}}</text>
            <view class="tab-indicator" wx:if="{{activeTab === item.value}}"></view>
          </view>
        </view>
      </view>

      <!-- 列表内容 -->
      <view class="list-container">
        <!-- 空状态 -->
        <view class="empty-wrapper" wx:if="{{notifications.length === 0 && !loading}}">
          <empty
            text="{{emptyText}}"
            type="{{activeTab === 'system' ? 'notification-system' : 'notification'}}"
          ></empty>
        </view>

        <!-- 通知列表 -->
        <view class="notification-list" wx:else>
          <view class="notification-item-wrapper" wx:for="{{notifications}}" wx:key="id">
            <notification-item
              notification="{{item}}"
              data-id="{{item.id}}"
              data-type="{{item.type}}"
              data-read="{{item.read}}"
              data-index="{{index}}"
              bind:tap="onNotificationTap"
            ></notification-item>
          </view>
        </view>

        <!-- 加载更多 -->
        <view wx:if="{{hasMore && notifications.length > 0}}" class="load-more">
          <view class="loading-text">加载更多...</view>
        </view>

        <!-- 已全部加载 -->
        <view wx:if="{{!hasMore && notifications.length > 0}}" class="load-more">
          <view class="no-more-text">没有更多了</view>
        </view>
      </view>
    </cell-status>
  </view>

  <!-- 顶部通知 -->
  <mp-toptips msg="{{toptipsMsg}}" type="{{toptipsType}}" show="{{toptipsShow}}"></mp-toptips>
</view> 